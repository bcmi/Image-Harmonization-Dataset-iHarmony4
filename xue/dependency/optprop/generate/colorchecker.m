function r=colorchecker(lam)
%COLORCHECKER Spectral data of a Macbeth ColorChecker.
%   R=COLORCHECKER returns the correspondning spectral reflectances
%   for the default wavelength range, DWL.
%   R=COLORCHECKER(LAM) returns the corresponding spectral readings for
%   wavelengths in LAM.
%
%   Remark:
%      Spectral data from http://www.cis.rit.edu/mcsl/online/cie.php
%
%   Example:
%      image(roo2rgb(colorchecker));
%      axis image;

% Part of the OptProp toolbox, $Version: 2.1 $
% Author:  Jerker Wågberg, More Research & DPC, Sweden
% Email: ['jerker.wagberg' char(64) 'more.se']

% $Id: colorchecker.m 23 2007-01-28 22:55:34Z jerkerw $

	persistent a
	if isempty(a)
		a=[
			 4.8  5.3  6.9 15.3 10.3  9.9  5.5 15.0 11.3  9.6  5.2 13.8  4.8 10.1  5.4 11.3 12.3  5.6 11.8  7.4 11.0  6.0  9.3  3.2
			 5.1  5.4  8.1 18.9 12.0 12.0  5.6 18.4 13.8 10.8  5.2 16.7  4.9 11.5  5.3 13.1 15.2  5.8 14.2  7.9 13.3  6.1 11.0  3.3
			 5.5  5.4  9.6 24.5 14.1 15.0  5.7 23.5 17.4 12.3  5.2 20.6  4.9 13.5  5.4 15.0 19.7  5.9 17.9  8.4 16.7  6.3 13.4  3.3
			 6.0  5.4 11.4 31.9 16.3 18.9  5.8 29.9 21.9 13.5  5.2 24.9  4.9 15.7  5.3 16.9 25.8  5.9 22.8  8.8 20.8  6.4 16.4  3.4
			 6.5  5.4 13.6 40.9 18.2 23.1  5.8 37.2 26.6 14.4  5.1 28.9  5.0 17.7  5.3 18.3 32.8  6.0 28.3  9.1 25.2  6.5 19.5  3.5
			 6.8  5.4 15.6 53.6 19.2 26.8  5.8 45.9 30.0 14.5  5.1 32.4  4.9 19.1  5.3 19.3 38.5  6.1 32.2  9.3 28.4  6.5 22.0  3.5
			 6.8  5.3 17.5 67.1 19.7 29.3  5.9 52.9 32.0 14.4  5.0 34.6  4.9 19.9  5.3 19.9 41.8  6.1 34.3  9.4 30.3  6.4 23.8  3.6
			 6.7  5.3 19.3 77.2 19.9 31.1  5.9 56.4 33.0 14.1  5.0 35.4  5.0 20.3  5.2 20.1 43.7  6.1 35.4  9.4 31.4  6.4 24.9  3.6
			 6.4  5.2 20.8 84.0 20.1 32.4  5.9 58.0 33.6 13.8  4.9 35.7  5.0 20.6  5.2 20.2 44.6  6.2 35.9  9.4 32.2  6.4 25.8  3.6
			 6.2  5.2 22.4 86.8 20.3 33.5  6.0 58.4 33.7 13.4  4.9 35.8  5.1 19.8  5.2 20.3 44.8  6.3 35.7  9.4 32.9  6.4 27.0  3.6
			 5.9  5.2 24.4 87.8 20.5 34.8  6.2 58.5 33.7 13.2  4.9 35.9  5.2 19.0  5.3 20.3 44.8  6.4 35.0  9.4 33.6  6.4 28.1  3.6
			 5.7  5.2 26.5 88.2 20.8 36.1  6.3 58.7 33.7 13.2  4.9 36.0  5.3 17.9  5.3 20.4 44.7  6.6 33.9  9.5 34.4  6.5 29.6  3.6
			 5.5  5.2 29.0 88.3 21.2 37.3  6.5 58.7 33.5 13.1  4.9 36.1  5.4 16.8  5.3 20.5 44.4  6.8 32.7  9.5 35.3  6.5 31.5  3.5
			 5.4  5.2 31.6 88.5 21.7 38.3  6.7 58.8 33.4 13.1  4.9 36.2  5.6 15.6  5.4 20.5 44.0  7.1 31.3  9.5 36.3  6.6 33.4  3.5
			 5.3  5.2 33.5 88.6 22.4 38.7  7.0 58.8 33.1 12.9  4.9 36.2  5.8 14.4  5.5 20.5 43.4  7.5 29.8  9.5 37.5  6.7 35.2  3.5
			 5.3  5.2 34.2 88.6 23.1 38.3  7.4 58.7 32.7 12.8  4.8 36.1  6.0 13.2  5.6 20.5 42.8  7.9 28.2  9.4 39.0  6.8 37.0  3.5
			 5.2  5.2 33.8 88.7 24.0 37.4  7.8 58.6 32.2 12.6  4.8 36.1  6.1 12.0  5.9 20.4 42.1  8.5 26.7  9.4 40.8  6.9 39.1  3.5
			 5.2  5.2 32.4 88.8 25.1 36.1  8.4 58.5 31.6 12.6  4.7 35.9  6.3 11.0  6.5 20.4 41.3  9.3 25.3  9.4 43.3  7.3 41.4  3.5
			 5.2  5.3 30.2 88.8 26.2 34.5  9.1 58.3 31.0 12.5  4.7 35.8  6.4 10.1  7.5 20.3 40.5 10.4 23.9  9.4 46.0  7.7 43.4  3.5
			 5.3  5.4 27.3 88.8 27.3 32.5 10.1 58.2 30.2 12.3  4.6 35.8  6.5  9.3  9.3 20.3 39.4 11.8 22.5  9.3 49.2  8.4 44.9  3.5
			 5.4  5.5 23.9 88.8 28.2 30.1 11.3 58.1 29.3 11.9  4.5 35.7  6.7  8.6 12.1 20.2 38.1 13.5 20.9  9.3 52.3  9.2 45.8  3.4
			 5.5  5.6 20.5 88.8 28.9 27.5 12.5 58.0 28.5 11.4  4.5 35.6  6.8  8.0 15.7 20.2 37.2 15.7 19.5  9.3 54.8 10.0 46.1  3.4
			 5.7  5.7 17.2 88.8 29.3 24.7 14.0 58.0 27.6 10.9  4.4 35.6  7.0  7.5 20.2 20.2 36.2 18.5 18.2  9.3 56.6 10.7 45.7  3.4
			 5.9  5.9 14.4 88.8 29.6 22.3 15.7 58.0 26.8 10.5  4.4 35.6  7.2  7.0 25.2 20.2 35.2 22.1 17.2  9.2 57.7 11.5 44.7  3.4
			 6.1  6.1 12.0 88.7 30.1 20.2 18.0 58.0 26.0 10.3  4.4 35.6  7.8  6.7 30.3 20.2 34.2 26.9 16.3  9.2 58.2 12.3 43.3  3.4
			 6.2  6.4 10.1 88.7 31.0 18.4 20.8 58.0 25.1 10.2  4.4 35.6  8.8  6.3 35.1 20.2 33.0 32.6 15.5  9.3 58.3 13.3 41.4  3.4
			 6.5  6.8  8.6 88.7 32.1 16.7 24.4 58.0 24.3 10.0  4.4 35.6 10.6  6.1 39.4 20.2 31.4 38.4 14.6  9.3 58.0 14.6 39.2  3.4
			 6.7  7.6  7.4 88.7 32.6 15.2 28.6 58.1 23.4  9.7  4.4 35.6 13.0  5.9 43.6 20.2 29.4 44.0 13.5  9.3 57.6 16.6 36.6  3.4
			 7.0  8.6  6.6 88.7 32.2 13.7 32.4 58.1 22.5  9.4  4.4 35.7 15.5  5.8 47.5 20.2 27.1 48.4 12.4  9.3 56.9 19.3 33.9  3.4
			 7.2 10.1  5.9 88.7 31.0 12.5 35.1 58.2 21.5  9.1  4.4 35.7 17.3  5.6 51.2 20.2 24.9 51.6 11.3  9.3 56.0 22.9 31.0  3.4
			 7.4 12.0  5.4 88.7 29.8 11.6 36.3 58.2 20.8  8.9  4.4 35.7 18.1  5.4 54.4 20.3 23.1 53.4 10.6  9.3 54.9 27.3 28.2  3.4
			 7.5 14.3  5.1 88.7 29.1 11.0 36.3 58.2 20.3  9.0  4.4 35.8 18.2  5.3 57.2 20.3 21.9 54.2 10.2  9.3 53.5 32.3 25.5  3.4
			 7.6 17.0  4.8 88.7 29.2 10.6 35.5 58.3 19.8  9.2  4.5 35.8 17.7  5.2 59.7 20.3 21.1 54.5 10.2  9.3 51.9 37.4 22.8  3.4
			 7.8 19.8  4.6 88.6 29.7 10.3 34.2 58.3 19.5  9.6  4.6 35.8 16.8  5.2 61.5 20.3 20.9 54.1 10.5  9.3 50.1 41.8 20.4  3.4
			 7.9 22.8  4.5 88.6 30.0  9.9 32.3 58.3 19.1 10.2  4.7 35.8 15.7  5.3 63.0 20.3 20.9 53.3 10.7  9.3 48.0 45.6 18.0  3.4
			 8.2 26.0  4.4 88.7 29.8  9.4 30.3 58.4 18.8 10.6  4.8 35.8 14.7  5.4 64.5 20.3 20.7 52.4 10.7  9.2 45.8 48.7 15.9  3.4
			 8.7 29.7  4.3 88.7 29.5  9.0 28.1 58.4 18.3 10.8  5.0 35.9 13.7  5.5 66.0 20.3 20.1 51.3 10.6  9.3 43.6 51.2 14.1  3.3
			 9.2 33.8  4.2 88.7 29.5  8.6 26.0 58.5 17.7 10.9  5.3 35.9 12.9  5.5 67.3 20.3 19.6 50.1 10.7  9.3 41.4 53.4 12.6  3.3
			10.0 38.0  4.1 88.8 30.5  8.3 23.8 58.6 17.2 11.2  5.7 36.0 12.6  5.4 68.6 20.4 19.6 48.7 11.2  9.3 39.2 55.4 11.4  3.3
			10.7 41.8  4.1 88.8 32.6  8.3 21.7 58.7 16.7 12.6  6.3 36.1 12.5  5.3 69.8 20.4 19.9 47.2 12.3  9.3 36.9 57.0 10.4  3.3
			11.5 45.2  4.0 88.7 35.8  8.3 19.6 58.8 16.3 15.7  7.2 36.1 12.2  5.2 70.8 20.5 20.6 45.4 14.1  9.3 34.6 58.4  9.7  3.3
			12.2 48.1  4.0 88.6 39.7  8.5 17.7 58.8 16.0 20.8  8.6 36.1 11.9  5.2 71.8 20.5 21.5 43.6 16.6  9.3 32.4 59.8  9.2  3.3
			12.9 50.3  4.0 88.6 43.5  8.6 15.8 58.8 15.7 27.4 10.9 36.1 11.5  5.3 72.6 20.5 22.3 41.6 19.8  9.3 30.2 60.9  8.8  3.3
			13.4 52.0  4.0 88.6 46.8  8.7 14.0 58.8 15.3 34.6 14.3 36.1 10.9  5.5 73.2 20.5 22.9 39.4 23.5  9.2 27.9 61.7  8.3  3.3
			13.8 53.2  3.9 88.7 49.4  8.7 12.4 58.8 15.0 41.5 19.2 36.0 10.4  5.9 73.7 20.4 23.5 37.4 27.9  9.2 26.0 62.4  8.0  3.3
			14.2 54.3  3.9 88.8 51.4  8.6 11.1 58.7 14.7 47.3 25.6 36.0 10.0  6.5 74.2 20.4 24.1 35.8 33.3  9.2 24.5 63.0  7.7  3.3
			14.6 55.2  4.0 88.9 53.0  8.5 10.1 58.6 14.4 51.7 33.2 35.9  9.8  7.4 74.6 20.4 24.5 34.6 39.4  9.2 23.4 63.5  7.5  3.3
			15.0 56.0  4.0 89.0 54.1  8.4  9.4 58.6 14.1 54.7 41.3 35.8  9.7  8.6 74.9 20.3 24.5 33.7 46.0  9.1 22.6 64.0  7.4  3.3
			15.4 56.6  4.0 89.1 55.0  8.4  8.9 58.5 13.7 56.7 48.6 35.7  9.8  9.9 75.3 20.3 24.3 33.1 52.2  9.1 22.1 64.5  7.3  3.3
			15.8 57.2  4.0 89.1 55.7  8.5  8.6 58.4 13.3 58.2 55.0 35.6 10.0 11.3 75.7 20.2 24.3 32.8 58.0  9.1 21.7 65.0  7.3  3.3
			16.3 57.8  4.1 89.1 56.4  8.8  8.4 58.3 13.0 59.1 59.8 35.5 10.0 12.6 76.1 20.1 24.7 32.5 62.8  9.0 21.5 65.4  7.3  3.3
			16.7 58.3  4.1 89.1 56.9  9.2  8.2 58.1 12.6 59.7 63.1 35.4  9.9 13.8 76.5 20.1 25.4 32.2 66.6  9.0 21.2 65.8  7.3  3.3
			17.3 58.7  4.2 89.0 57.4  9.8  8.0 58.0 12.3 60.1 65.4 35.3  9.7 14.9 76.8 20.0 26.9 32.0 69.6  9.0 21.0 66.2  7.3  3.3
			18.0 59.3  4.2 88.9 58.2 10.5  7.8 57.9 12.0 60.4 67.2 35.2  9.6 16.1 77.2 19.9 29.1 31.9 72.2  9.0 20.9 66.7  7.3  3.3
			18.8 59.9  4.2 88.9 59.0 11.1  7.7 57.8 11.8 60.7 68.6 35.1  9.5 17.2 77.7 19.8 31.8 31.9 74.2  8.9 20.8 67.2  7.4  3.3
			19.6 60.2  4.3 88.9 59.7 11.8  7.6 57.7 11.5 60.8 69.4 35.0  9.5 18.2 77.9 19.8 35.1 32.0 75.6  8.9 20.9 67.5  7.5  3.3
			20.4 60.4  4.3 88.9 60.5 12.3  7.5 57.6 11.2 60.7 70.0 34.9  9.5 19.3 78.0 19.7 38.4 32.4 76.6  8.9 21.1 67.6  7.6  3.3
			21.3 60.6  4.3 88.9 61.4 12.6  7.5 57.5 11.0 60.6 70.4 34.8  9.7 20.5 78.0 19.7 41.7 33.0 77.4  8.8 21.5 67.7  7.6  3.3
			22.2 60.8  4.4 88.8 62.4 12.6  7.5 57.4 10.8 60.5 70.7 34.6 10.1 21.7 78.1 19.6 44.6 33.7 78.0  8.8 22.0 67.8  7.7  3.3
			23.1 61.1  4.4 88.8 63.7 12.4  7.7 57.3 10.6 60.5 71.2 34.6 11.0 23.2 78.2 19.5 47.0 34.5 78.5  8.8 22.7 68.1  7.6  3.3
			24.2 61.5  4.4 88.8 65.2 12.0  7.8 57.2 10.5 60.5 71.8 34.5 12.5 24.8 78.5 19.5 49.0 35.4 79.1  8.7 23.3 68.5  7.5  3.3
			25.1 61.9  4.4 88.8 66.8 11.7  8.0 57.1 10.4 60.4 72.1 34.4 14.7 26.6 78.5 19.4 50.4 36.2 79.4  8.7 23.9 68.8  7.4  3.3
			26.1 62.2  4.5 88.8 68.2 11.5  8.2 57.0 10.4 60.5 72.4 34.3 17.4 28.2 78.7 19.4 51.1 36.8 79.8  8.7 24.4 69.0  7.4  3.2
			27.1 62.5  4.6 88.8 69.7 11.5  8.5 56.9 10.3 60.6 72.7 34.2 21.0 30.1 78.9 19.3 51.7 37.5 80.1  8.7 24.9 69.3  7.3  3.2
			28.2 62.8  4.8 88.8 71.3 11.6  8.8 56.8 10.3 60.6 72.9 34.1 24.7 31.9 79.2 19.2 52.0 37.9 80.4  8.6 25.2 69.6  7.2  3.2
			29.4 63.0  5.0 88.7 72.8 11.8  8.9 56.7 10.2 60.4 73.0 34.0 28.3 33.8 79.2 19.2 52.2 38.1 80.6  8.6 25.2 69.8  7.2  3.2
			30.5 63.3  5.1 88.6 74.5 12.0  8.9 56.6 10.2 60.2 73.0 33.9 31.1 35.5 79.3 19.1 52.3 37.9 80.7  8.6 25.0 69.8  7.1  3.2
			31.8 63.3  5.3 88.6 75.3 12.4  9.0 56.5 10.2 60.1 72.9 33.8 32.9 37.1 79.2 19.1 52.2 37.6 80.7  8.6 24.8 69.8  7.3  3.2
			33.4 63.3  5.6 88.6 76.2 12.8  9.0 56.4 10.2 59.9 72.7 33.7 34.3 38.8 79.0 19.0 52.1 37.3 80.7  8.5 24.4 69.8  7.5  3.2
			35.4 63.6  6.0 88.5 77.4 13.3  9.0 56.2 10.2 59.8 72.8 33.6 35.3 40.6 79.2 18.9 52.1 37.2 81.0  8.5 24.5 70.0  7.8  3.2
			37.2 63.7  6.4 88.5 78.3 13.9  8.9 56.2 10.2 59.6 72.9 33.5 35.8 42.2 79.2 18.9 52.2 37.5 81.3  8.5 24.5 70.1  8.2  3.2
			39.2 63.9  7.0 88.5 78.8 14.9  9.2 56.0 10.4 59.5 72.9 33.4 36.2 43.6 79.0 18.8 52.1 38.2 81.4  8.5 25.1 70.1  9.0  3.2
			40.9 63.8  7.9 88.4 79.1 16.2  9.4 56.0 10.4 59.3 72.7 33.3 36.4 45.1 78.7 18.8 52.1 39.2 81.3  8.5 26.0 70.1 10.0  3.2
			42.0 63.3  9.1 88.4 78.7 17.8  9.7 55.8 10.4 58.7 72.3 33.2 36.0 46.0 78.2 18.7 51.6 40.1 81.0  8.4 26.9 69.5 11.6  3.2
			43.6 63.3 10.4 88.3 78.9 19.7 10.2 55.7 10.4 58.4 72.1 33.1 36.2 47.1 77.8 18.7 51.4 41.2 80.8  8.4 27.8 69.4 13.3  3.2
			45.0 63.6 12.0 88.2 79.4 21.9 10.6 55.6 10.6 58.4 72.4 33.0 36.4 48.1 78.0 18.6 51.4 42.2 81.1  8.4 28.8 69.6 15.4  3.2
			46.2 64.1 13.8 88.2 80.1 24.2 11.0 55.5 10.6 58.6 72.8 32.9 36.8 49.2 78.2 18.5 51.7 43.3 81.4  8.4 29.7 70.0 17.6  3.2
			46.5 63.9 15.4 88.1 79.9 25.9 11.1 55.4 10.7 58.4 72.7 32.8 36.8 49.5 78.1 18.5 51.5 43.6 81.3  8.4 30.1 69.8 19.1  3.2
			44.8 61.6 16.8 88.0 77.1 27.5 11.2 55.3 11.0 56.6 70.2 32.7 35.5 48.2 75.2 18.4 50.0 42.6 78.5  8.3 29.7 67.3 20.0  3.2
			43.2 59.8 18.6 88.0 74.7 29.4 11.2 55.1 11.5 55.1 68.0 32.6 34.6 47.1 72.8 18.4 49.1 41.3 76.5  8.3 29.6 65.3 20.8  3.2
			42.1 58.2 20.4 87.9 73.4 31.6 11.2 55.0 12.0 54.0 66.4 32.5 34.1 46.7 71.0 18.3 48.7 40.4 75.2  8.3 29.6 63.9 21.4  3.2
			];
		end
	ilam=380:5:780;
	if nargin < 1 || isempty(lam)
		lam=dwl;
		end
	r=interp1(ilam',a,lam','linear',0);
	r=reshape(r',4,6,length(lam));
